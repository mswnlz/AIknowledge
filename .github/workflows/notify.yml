name: Notify Multiple Telegram Chats on GitHub Push
description: |
  This GitHub Action sends a notification to multiple Telegram chats whenever there is a push to the main branch.
  It uses the Telegram Bot API to send messages.
on:
  push:
    branches:
      - main

jobs:
  notify:
    runs-on: ubuntu-latest
    steps:
      - name: Send commit message to multiple Telegram chats
        env:
          BOT_TOKEN: ${{ secrets.BOT_TOKEN }}
          CHAT_IDS: ${{ vars.TELEGRAM_CHAT_IDS }}
        run: |
          IFS=',' read -ra IDS <<< "$CHAT_IDS"
          for chat in "${IDS[@]}"; do
            response=$(curl -s -X POST "https://api.telegram.org/bot${BOT_TOKEN}/sendMessage" \
              -d chat_id="$chat" \
              --data-urlencode "text=📢 [${{ github.repository }}] 有新提交！
              👤 作者: ${{ github.actor }}
              📝 提交说明: ${{ github.event.head_commit.message }}
              🔗 查看: https://github.com/${{ github.repository }}/commit/${{ github.sha }}" \
              -d parse_mode="Markdown"
            echo "Telegram response for chat_id $chat: $response"
          done

          